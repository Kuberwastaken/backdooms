<!DOCTYPE html><html><head><meta charset="utf-8"><title>Mini DOOM</title><style>body{margin:0;overflow:hidden;background:#000;cursor:crosshair}canvas{width:100vw;height:100vh}</style></head><body><canvas id=c></canvas><script>
    c=document.getElementById("c");c.width=320,c.height=240,h=c.getContext("2d");x=4,y=4,a=0,hp=100,am=25,rc=0,fl=0;
    f=(i,j)=>(Math.abs(i-4)<3&&Math.abs(j-4)<3)?"0":(n=Math.sin(i*12.9898+j*78.233)*43758.5453+1e4,n-=n|0,n<.15?"1":"0");
    e=[{x:6,y:4,h:100},{x:4,y:6,h:100},{x:6,y:6,h:100}],k={},p=[];
    onkeydown=e=>{k[e.key]=1};onkeyup=e=>{k[e.key]=0};
    onclick=_=>{if(am){am--;fl=2;rc=.2;h.fillStyle="#FFA500";h.fillRect(140,160,40,20);e.forEach(o=>{d=Math.hypot(o.x-x,o.y-y),r=Math.atan2(o.y-y,o.x-x);if(d<5&&Math.abs(r-a)<.3)o.h-=50})}};
    R=_=>{
     rc=Math.max(0,rc-.02);fl=Math.max(0,fl-1);e=e.filter(o=>o.h>0);
     h.fillStyle="#000";h.fillRect(0,0,320,240);
     if(k.ArrowLeft)a-=.1;if(k.ArrowRight)a+=.1;m=.1;
     if(k.ArrowUp||k.w){nx=x+Math.cos(a)*m;ny=y+Math.sin(a)*m;if(f(~~nx,~~ny)!="1"){x=nx,y=ny}};
     if(k.ArrowDown||k.s){nx=x-Math.cos(a)*m;ny=y-Math.sin(a)*m;if(f(~~nx,~~ny)!="1"){x=nx,y=ny}};
     e.forEach(o=>{
      if(o.h>0){
       dx=x-o.x,dy=y-o.y,di=Math.hypot(dx,dy);
       if(di>0.2){nx=o.x+dx/di*.001;ny=o.y+dy/di*.001;if(f(~~nx,~~ny)!="1"){o.x=nx;o.y=ny}};
       if(di<.5){hp--;fl=2};
       if(o.h<=50&&Math.random()<.02)p.push({x:o.x,y:o.y,t:20})
      }
     });
     if(Math.random()<.005&&am<25)am++;
     if(e.length<40&&Math.random()<.1){X=x+(Math.random()*30-15);Y=y+(Math.random()*30-15);if(f(~~X,~~Y)=="0")e.push({x:X,y:Y,h:100})};
     w=[];
     for(i=0;i<320;i++){
      r=a+Math.atan((i-160)/160),rx=x,ry=y,s=Math.sin(r),c=Math.cos(r),d=0;
      while(d<20&&f(~~rx,~~ry)!="1"){rx+=c*.1;ry+=s*.1;d+=.1};
      d*=Math.cos(r-a);w[i]=d;h2=Math.min(240,240/d);g=Math.min(255,200/d)|0;
      h.fillStyle="rgb("+g+","+g+","+g+")";h.fillRect(i,120-h2/2+rc*20,1,h2)
     };
     e.forEach(o=>{
      d=Math.hypot(o.x-x,o.y-y),r=Math.atan2(o.y-y,o.x-x)-a;
      if(Math.abs(r)<1.2){
       sz=80/d;px=160+r*160;
       if(px>=0&&px<320&&d<w[~~px]){
        h.fillStyle=o.h>50?"#400":"#800";h.fillRect(px-sz/2,120-sz/2+rc*20,sz,sz);
        h.fillStyle="#f00";h.fillRect(px-sz/4,120-sz/2+rc*20,sz/8,sz/8);
        h.fillRect(px+sz/4,120-sz/2+rc*20,sz/8,sz/8);
        h.fillStyle="#900";h.fillRect(px-sz/2,120-sz/2-4+rc*20,sz,2);
        h.fillStyle="#0f0";h.fillRect(px-sz/2,120-sz/2-4+rc*20,sz*(o.h/100),2)
       }
      }
     });
     p=p.filter(o=>{
      if(o.t>0){h.fillStyle="rgba(255,0,0,"+o.t/20+")";h.fillRect(160+Math.atan2(o.y-y,o.x-x)*160-10,120-10+rc*20,20,20);o.t--;return o.t>0}return 0});
     h.fillStyle="#444";h.fillRect(140,180+rc*20,40,60);
     if(fl){h.fillStyle="#FFA500";h.fillRect(140,160+rc*20,40,20)};
     h.fillStyle="#f00";h.fillRect(10,10,hp,10);
     h.fillStyle="#ff0";h.fillRect(10,25,am*4,5);
     h.fillStyle="#fff";h.font="8px Arial";
     h.fillText("HP",10,8);h.fillText("AMMO:"+am,10,23);h.fillText("2hits/kill",2,235);
     h.textAlign="right";h.fillText("Made w/<3 Kuber",315,235);h.textAlign="left";
     hp>0?requestAnimationFrame(R):(h.fillStyle="#000a",h.fillRect(0,0,320,240),h.fillStyle="#f00",h.font="20px Arial",h.textAlign="center",h.fillText("GAME OVER",160,110),h.fillText("F5 to retry",160,130))
    };
    R();
    </script></body></html>
    