<canvas id=c></canvas><script>c=document.querySelector('#c');c.width=320;c.height=240;h=c.getContext('2d');x=3;y=3;a=0;hp=100;m=[..."11111111 10000001 10100101 10000001 10100101 10000001 10100101 11111111".split` `];e=[{x:6,y:4,h:100},{x:4,y:6,h:100},{x:6,y:6,h:100}];k={};f=0;onkeydown=e=>{k[e.key]=1;if(e.key==' ')S()};onkeyup=e=>k[e.key]=0;S=_=>{f=2;e.forEach(m=>{for(i=-1;i<2;i++){r=Math.atan2(m.y-y,m.x-x);d=Math.hypot(m.x-x,m.y-y);if(d<3&&Math.abs(r-a+i*.1)<.9)m.h-=17}})};R=_=>{h.fillStyle='#000';h.fillRect(0,0,320,240);h.fillStyle='#333';h.fillRect(0,0,320,120);h.fillStyle='#555';h.fillRect(0,120,320,120);if(k.ArrowLeft)a-=.1;if(k.ArrowRight)a+=.1;if(k.ArrowUp){nx=x+Math.cos(a)*.1;ny=y+Math.sin(a)*.1;if(m[~~ny][~~nx]!='1'){x=nx;y=ny}}for(i=0;i<320;i++){r=a+Math.atan((i-160)/160);rx=x;ry=y;s=Math.sin(r);c=Math.cos(r);d=0;while(d<8&&m[~~ry][~~rx]!='1'){rx+=c*.05;ry+=s*.05;d+=.05}d*=Math.cos(r-a);h2=Math.min(240,120/d);h.fillStyle=`rgb(${100/d},${100/d},${100/d})`;h.fillRect(i,120-h2/2,1,h2)}e.forEach(m=>{if(m.h<=0)return;d=Math.hypot(m.x-x,m.y-y);if(d<.5)hp-=1;r=Math.atan2(m.y-y,m.x-x)-a;sz=100/d;if(Math.abs(r)<1.2){px=160+r*160;py=120;h.fillStyle='#2a0';h.beginPath();h.moveTo(px-sz,py-sz);h.lineTo(px-sz/2,py+sz);h.lineTo(px+sz/2,py+sz);h.lineTo(px+sz,py-sz);h.fill();h.fillStyle='#f0f';h.fillRect(px-sz/2,py-sz/1.5,sz/3,sz/3);h.fillRect(px+sz/3,py-sz/1.5,sz/3,sz/3);h.fillStyle='#f00';h.fillRect(px-sz/4,py+sz/4,sz/2,sz/8)}});h.fillStyle='#444';h.fillRect(140,180,40,60);if(f>0){h.fillStyle='#fff';h.fillRect(155,170,10,5);f--}h.fillStyle='#f00';h.fillRect(10,10,hp,10);if(hp>0)requestAnimationFrame(R);else{h.fillStyle='#f00';h.font='40px Arial';h.fillText('GAME OVER',80,120)}};R();c.style.cssText='width:100vw;height:100vh;background:#000';document.body.style.cssText='margin:0;overflow:hidden';</script>